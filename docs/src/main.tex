\documentclass[12pt]{article}

% Packages
\usepackage[margin=1in]{geometry}  % Page margins
\usepackage{titlesec}              % For formatting section titles
\usepackage{enumitem}              % For better list formatting


% Title formatting
\titleformat{\section}
  {\large\bfseries}  % Format of the section title
  {}                 % Label
  {0pt}              % Separation between label and title
  {}                 % Before-code

% Define heading formats
\titlespacing*{\section}{0pt}{24pt}{12pt}
\titlespacing*{\subsection}{0pt}{12pt}{6pt}

% Document begins
\begin{document}

% Title
{\centering
\Huge\textbf{MITRE eCTF 2025}

\vspace{1cm}
\Large\textbf{Initial Design Document: Team Spartans}

\vspace{0.5cm}
\Large [Michigan State University]

\vspace{2cm}
}

\section*{Overview of our System}

Our system will involve a series of \textbf{control keys} K1, K2, \ldots, Kn (one for each decoder n) for the entire system and a series of \textbf{channel keys} for each channel. The control key will be preloaded into the firmware of the decoder and only accessible upon selective calls from secure functions. 

Upon successful negotiation between the TV service and client for channel access, the client will be able to upload a signed \textbf{subscription package} to their decoder. The package contains a key to be used in decrypting a specific channel's frames, and is encrypted using the control key specific to that decoder. 

The package is also signed for authenticity using a \textbf{manufacturer keypair}, where the \textbf{manufacturer secret key} is held by the encoder, and all decoders receive the \textbf{manufacturer public key} by which they can verify the signature of the package. The channel key is only usable by the decoder once decrypted by the pre-shared control key. If the client purchases X number of channels at the same time, they will receive X encrypted and signed channel keys.

\newpage
% Build Process section
\section*{Build Process}

\subsection*{Build Environment}
While building the environment for a single deployment, the following keys will be generated and stored in the Global Secrets:
\begin{itemize}
  \item Manufacturer Keypair
  \item Control Keys (one per decoder)
  \item Channel Keys for Channels 1-4
\end{itemize}

\subsection*{Build Decoder}
When building the decoder, it is provided with:
\begin{itemize}
  \item Control key (specific to this decoder)
  \item Manufacturer Public Key
  \item Channel Key for Channel 0
\end{itemize}

\vspace{1cm}

% Security Requirements section
\section*{Security Requirements}

\subsection*{Security Requirement 1}
\textbf{An attacker should not be able to decode TV frames without a Decoder that has a valid, active subscription to that channel.}

All frames sent by the system will be encrypted with the channel key by the Encoder. This key will be shared through the subscription package, which will be encrypted using the pre-shared key between the encoder and valid decoders, and derived from the Global Secrets for the Deployment. As such, a third party should not have access to the channel key and be able to decode frames for the channels that are encrypted by the Encoder.

\subsection*{Security Requirement 2}
\textbf{The Decoder should only decode valid TV frames generated by the Satellite System the Decoder was provisioned for.}

A third party without the \textit{channel key} should not be able to create frames that are encrypted with this key, assuming the secrets in decoder firmware and the encoder infrastructure are inaccessible to the attacker. Since the subscription packages will be encrypted with the pre-shared key, they cannot be read by parties other than the Encoder and Decoder. The frames may also be additionally signed using a Manufacturer Secret Key to verify the authenticity, if the process fits within the time constraints for decoding a frame.

\subsection*{Security Requirement 3}
\textbf{The Decoder should only decode frames with strictly monotonically increasing timestamps.}

The firmware will keep track of the last frame received for each channel in volatile memory. If a received frame has a timestamp lower than this value, the decoder will reject decoding the frame.

\newpage
% Functional Requirements section
\section*{Encoder Functional Requirements}

\subsection*{Encode Frames}
The encoder will encode each channel's frames with a \textit{channel key}, then it will associate the channel number and timestamp with the frame. Each frame may also be signed by the Manufacturer Secret Key. Each frame will then be sent to the uplink to be transmitted to the satellite.

\section*{Decoder Functional Requirements}

\subsection*{Decoder Functional Requirement 1}
\textbf{List Channels}

The decoder will maintain a list of channels it has a valid subscription for. Upon receiving an authentic subscription update package, the decoder will update the list. Once a subscription has ended, the access to the channel will be removed from the list.

\subsection*{Decoder Functional Requirement 2}
\textbf{Update Subscriptions}

Upon receiving a subscription update, the decoder will update the specified channel or set of channels as a part of the update package. After decrypting the \textit{channel keys} associated with a specific channel, it will store them and then update the channels list.

\subsection*{Decoder Functional Requirement 3}
\textbf{Decode Frame}

When attempting to view a channel, the decoder will check against the channel list to ensure it has access to the channel. If it has access, then it will use the \textit{channel key} to decrypt each frame and will check against the associated time stamp in the frame with the access period of the channel subscription. If all of the attributes are valid then the frame will be viewable, otherwise the frames will remain encoded.

\section*{Security Enhancement}
The use of a series of keys K1, K2, \ldots, Kn specific to each decoder n keeps the system secure in the Pirated Subscription scenario. Each subscription package will be signed by a key specific to the decoder the channel is being provisioned for, to prevent other decoders in the same deployment from decrypting it. The encryption of channel frames remains the same, using the channel key.

\section*{Key Management}


\end{document}
